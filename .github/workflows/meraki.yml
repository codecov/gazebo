name: Deploy meraki

on:
  push:
    branches:
      - meraki_epic
      - main

jobs:
  release:
    uses: ./.github/workflows/client-release.yml
    secrets:
      bucket: ${{ secrets.bucket_meraki }}
      client_name: ${{ secrets.client_meraki }}
      api_url: ${{ secrets.api_url_meraki }}
      base_url: ${{ secrets.base_url_meraki }}
      default_provider: ${{ secrets.default_provider_meraki }}
      token: ${{ secrets.GITHUB_TOKEN }}
      gcp_sa: ${{ secrets.CODECOV_GCP_WIDSA }}
      gcp_idp: ${{ secrets.CODECOV_GCP_WIDP }}
    permissions:
      pull-requests: 'write'
      contents: 'read'
      id-token: 'write'
      actions: 'read'
      repository-projects: 'read'
